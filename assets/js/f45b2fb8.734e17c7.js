"use strict";(self.webpackChunkgiveth_docs=self.webpackChunkgiveth_docs||[]).push([[7684],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>p});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},h=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),u=d(n),p=a,g=u["".concat(l,".").concat(p)]||u[p]||c[p]||r;return n?i.createElement(g,o(o({ref:t},h),{},{components:n})):i.createElement(g,o({ref:t},h))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var d=2;d<r;d++)o[d]=n[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7860:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>h});var i=n(7462),a=(n(7294),n(3905)),r=n(4996);const o={id:"bridgeSecurity",title:"Giveth Bridge Security Implementation",slug:"dapps/bridgeSecurity"},s=void 0,l={unversionedId:"bridgeSecurity",id:"bridgeSecurity",title:"Giveth Bridge Security Implementation",description:"A technical overview of the features, roles and theory behind the security of the Giveth Bridge.",source:"@site/dapps/bridgeSecurity.md",sourceDirName:".",slug:"/dapps/bridgeSecurity",permalink:"/dapps/bridgeSecurity",draft:!1,editUrl:"https://github.com/giveth/giveth-docs/edit/master/dapps/bridgeSecurity.md",tags:[],version:"current",lastUpdatedBy:"mitch",lastUpdatedAt:1641567780,formattedLastUpdatedAt:"Jan 7, 2022",frontMatter:{id:"bridgeSecurity",title:"Giveth Bridge Security Implementation",slug:"dapps/bridgeSecurity"},sidebar:"dapps",previous:{title:"Installing Giveth TRACE for Local Development",permalink:"/dapps/TRACEinstallation"},next:{title:"Development Process",permalink:"/dapps/developmentProcess"}},d={},h=[{value:"A technical overview of the features, roles and theory behind the security of the Giveth Bridge.",id:"a-technical-overview-of-the-features-roles-and-theory-behind-the-security-of-the-giveth-bridge",level:4},{value:"What is the Giveth Bridge, exactly?",id:"what-is-the-giveth-bridge-exactly",level:3},{value:"How does it work?",id:"how-does-it-work",level:3},{value:"Security Roles",id:"security-roles",level:2},{value:"Mainnet Owner",id:"mainnet-owner",level:3},{value:"Mainnet Funding and EscapeHatch Destination",id:"mainnet-funding-and-escapehatch-destination",level:3},{value:"Security Guard",id:"security-guard",level:3},{value:"Mainnet EscapeHatchCaller",id:"mainnet-escapehatchcaller",level:3},{value:"Allowed Spenders",id:"allowed-spenders",level:3},{value:"ForeignGivethBridge Owner",id:"foreigngivethbridge-owner",level:3},{value:"Rinkeby DappGod Multisig",id:"rinkeby-dappgod-multisig",level:3},{value:"Rinkeby EscapeHatchCaller",id:"rinkeby-escapehatchcaller",level:3},{value:"Possible Security Issue Scenarios",id:"possible-security-issue-scenarios",level:2}],c={toc:h};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h4",{id:"a-technical-overview-of-the-features-roles-and-theory-behind-the-security-of-the-giveth-bridge"},"A technical overview of the features, roles and theory behind the security of the Giveth Bridge."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"This document assumes that the reader has basic knowledge of smart contracts, multisig contracts and Ethereum testnet chains.")),(0,a.kt)("h3",{id:"what-is-the-giveth-bridge-exactly"},"What is the Giveth Bridge, exactly?"),(0,a.kt)("p",null,"The bridge has 3 parts: A contract on the Ethereum Mainnet, a contract on the Rinkeby Testnet, and an off-chain service that connects these two contracts. The off-chain service listens for events from these contracts and relays commands from one contract to the other."),(0,a.kt)("img",{id:"contentimg",alt:"Giveth TRACE Bridge Flow",src:(0,r.Z)("img/content/trace/givethbridge.png")}),(0,a.kt)("h3",{id:"how-does-it-work"},"How does it work?"),(0,a.kt)("p",null,"The Giveth Bridge contract on mainnet is simply a vault contract with 1 extra security measure and a few modifications to make it function as a bridge. Payments are only paid out under certain conditions. Every bridge payment has a standard 48-hour time lockout before payment can occur."),(0,a.kt)("p",null,"During this time, the Security Guard has the ability to delay a payment further than the standard 48 hours - up to 30 days. This allows time to determine whether or not a payment needs to be cancelled. No payments can be issued without a check-in from the Security Guard happening XX minutes after the payment was requested. This check-in will happen daily so as not to delay authorized payments."),(0,a.kt)("p",null,"There is also an ",(0,a.kt)("inlineCode",{parentName:"p"},"escapeHatch")," that can be called by an ",(0,a.kt)("inlineCode",{parentName:"p"},"escapeHatchCaller")," to send the funds in the bridge to the funding multisig during the 48 hour delay, or any additional delay generated by the Security Guard."),(0,a.kt)("p",null,"This funding multisig will for some time also hold funds to diversify risk between the Bridge contract and the Consensus Multisig contract, when the bridge is holding too much value the funding multisig will ",(0,a.kt)("inlineCode",{parentName:"p"},"escapeFunds()")," out of the bridge and when the bridge is getting low, the funding multisig will manually top it off."),(0,a.kt)("p",null,"Donations and withdrawals will happen directly out of the bridge. When a donation is made to the bridge, a token is created by the TokenFactory (at 1:1 ETH) and sent to LiquidPledging, where the decisions are made about spending. When a payment is called for, tokens are sent from Liquid Pledging and burned by the ForeignGivethBridge, at which point the command is issued back across the Ghetto Bridge using the Bridge Key to the Giveth Bridge to issue a payment."),(0,a.kt)("p",null,"In case for some reason the bridge goes down, the listener service will issue alarms to notify of a service interruption. The listener service will also create an alarm if tokens are created without a corresponding donation, or if tokens are not created at the time of a donation."),(0,a.kt)("h2",{id:"security-roles"},"Security Roles"),(0,a.kt)("h3",{id:"mainnet-owner"},"Mainnet Owner"),(0,a.kt)("p",null,"This is the Giveth multisig that can issue control commands to the bridge. They can cancel any payment and can boot the Security Guard or remove the approved spender (bridge key)."),(0,a.kt)("h3",{id:"mainnet-funding-and-escapehatch-destination"},"Mainnet Funding and EscapeHatch Destination"),(0,a.kt)("p",null,"This multisig is used to both send funds to the Mainnet Bridge (Vault) and act as the destination for the EscapeHatch Call."),(0,a.kt)("h3",{id:"security-guard"},"Security Guard"),(0,a.kt)("p",null,"Keeps watch over all requested payments, checks in each day, and delays suspicious payments."),(0,a.kt)("h3",{id:"mainnet-escapehatchcaller"},"Mainnet EscapeHatchCaller"),(0,a.kt)("p",null,"This is a 1 of x multisig that can trigger the vault to dump its funds to a predetermined wallet. We have people that are scattered across the world, multiple points of contacts that can do this."),(0,a.kt)("h3",{id:"allowed-spenders"},"Allowed Spenders"),(0,a.kt)("p",null,"These addresses are a whitelist who can issue a payment request to the bridge contract. In the application the bridge key is the only Allowed Spender."),(0,a.kt)("h3",{id:"foreigngivethbridge-owner"},"ForeignGivethBridge Owner"),(0,a.kt)("p",null,"The bridge key."),(0,a.kt)("h3",{id:"rinkeby-dappgod-multisig"},"Rinkeby DappGod Multisig"),(0,a.kt)("p",null,"This multisig controls updates and has total access to control the ForeignGivethBridge. It also acts as the ",(0,a.kt)("inlineCode",{parentName:"p"},"escapeHatchDestination")," for the ForeignGivethBridge and Liquid Pledging."),(0,a.kt)("h3",{id:"rinkeby-escapehatchcaller"},"Rinkeby EscapeHatchCaller"),(0,a.kt)("p",null,"This is a 1 of x multisig that can trigger the ForeignGivethBridge and Liquid Pledging contracts to dump their tokens to a predetermined wallet."),(0,a.kt)("h2",{id:"possible-security-issue-scenarios"},"Possible Security Issue Scenarios"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Bridge Key is compromised:"),"\nA hacker could use bridge key to create transactions sending ETH to their own address to force transactions through. The Security Guard can delay these payments long enough for the owner multisig to cancel the payment and remove the compromised key on Mainnet."),(0,a.kt)("p",null,"They could also create GivETH tokens as the token controller on the rinkeby side. The listener service would catch this though and sound the alarm any time GivETH tokens are generated without a corresponding Ether donation. (also sounds an alarm if the bridge key service decided to take a nap and doesn\u2019t create GivETH tokens when a donation is received.)"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Owner multisig has a bug and is able to be taken over (like the parity hack) or 6 keys out of 11 of the keys are compromised:"),"\nThis is highly unlikely but if this happens there will be no loss of funds. This multisig doesn't hold any funds, it only controls the bridge. Tt could reduce the 48 hour delay to 25 hours, the Security Guard can still delay any payments but the Security Guard can be replaced by the owner. Funds could be escaped within the 25 hours in this scenario."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"EscapeHatchCaller keys get compromised:"),"\nIn this case the worst thing that can happen is that the flow of the DApp on Rinkeby can be disrupted. This can be repaired however, by removing the compromised key on the EscapeHatch 1 of x multisig, and DAppGod. Once that is done then simply sending the giveth tokens back to the address from which they came, a similar scenario is possible on Mainnet. The EscapeHatch Caller can only move money to an escape destination, and nowhere else. If a key is compromised the worst thing they can do is to remove all owners and themselves from the EscapeHatch multisig, but the owner 6 of 11 multisig on main net can still call the EscapeHatch and can replace the EscapeHatch caller and the 3 of 5 multisig on rinkeby can as well."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Funding multisig has a bug and is able to be taken over (like the parity hack) or 4 keys out of 7 of the keys are compromised:"),"\nThis is extremely unlikely but if this happens there will be a loss of funds. The loss however, would not be catastrophic as funds are split between the bridge and the multisig."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Bridge on mainnet has a bug that lets someone else take over as owner:"),"\nThe 48 hour delay can be only be reduced to 25 hours Security Guard can still delay any payments but the Security Guard can be replaced by the owner. Funds could be escaped within 25 hours in this scenario."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"DAppGod Multisig on the testnet decides to take over:"),"\nIf this were to occur, the EscapeHatch from the bridge would prevent any loss of funds, and the testnet set up could be manually redeployed."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"What if the Security Guard\u2019s key and Bridge Key Controller both get compromised (or their holders collude to steal funds)"),":\nThe Owner multisig can cancel payments and extend the time delay to longer than 48 hours. In this scenario though they probably wouldn't have to because the bridge funds can be escaped to the funding multisig. This is the only scenario that could be a serious risk to the funds in the bridge vault. This could be averted within 48 hours of the event starting because of the default delay and that funds can be escaped during that period."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Finally, what if the Event Listener falls off-line just previous to any of the aforementioned attacks that trigger alarms on compromise?"),"\nThe Security Guard should see any suspicious transactions and be able to delay payments until they are dealt with."))}u.isMDXComponent=!0}}]);